# PRD: 프로젝트 인지형 코딩 최적화 CLI (RAG + REST LLM)

## 1. 개요
- 목적: REST로 LLM을 연동하고, 프로젝트 인지형 RAG를 탑재한 Claude Code 스타일 개발 보조 CLI 제공.
- 핵심가치: 빠른 코드 탐색, 정확한 수정 제안, 자동 게이트(`make fmt && make test && make lint`)를 통한 신뢰성.
- 프로그램 명령어: `mycoder` (단일 바이너리)
- 설치 기본 경로: `$HOME/.mycoder/bin/mycoder` (`make install`), PATH 힌트 자동 출력
- 성공지표:
  - 인덱싱 완료 후 응답 p50 < 5s, 콜드 스타트 < 60s.
  - 패치 적용 후 포맷/린트 95% 1회 통과.
  - 검색 인용 정확도 ≥ 80% (파일/라인 근거 포함).
  - 비밀정보 노출 0, 실행 로그 재현 가능.
  - 메모리 성능: 요약 품질 만족도, 세션 TTL/압축 후 정확 맥락 유지율.
  - 로컬 LLM 지원: LM Studio(OpenAI 호환)로 완전 오프라인 동작.

## 2. 사용자 및 시나리오
- 페르소나
  - 개발자: 코드 탐색/설명/편집/테스트 자동화.
  - 테크리드: 후크 준수, 감사 가능한 실행 내역.
  - DevOps: 간편 설치, 보안 토큰 관리, 리소스 제어.
- 주요 시나리오
  - 질문/답변: 코드/문서 근거 인용 포함 Q&A.
  - 편집: 목표 → 패치 계획 → 미리보기 → 적용 → 게이트 통과.
  - 설명: 파일/심볼/모듈 요약 및 흐름 파악.
  - 계획: 코드 위치와 연결된 단계별 계획 생성.
  - 인덱스: 초기+증분 인덱싱.
  - 지식 확장: 부족시 웹 검색 → 검증 후 지식 저장.

## 3. 범위
- 포함(v1): CLI, 로컬 데몬(HTTP), 인덱서, RAG, REST LLM 게이트웨이, 기본 도구(포맷/린트/테스트), 웹 검색(옵션).
- 제외(v1): IDE 플러그인, 다중 리포 동시 오케스트레이션, 모델 파인튜닝.

## 4. 비기능 요구사항
- 성능: 동시 인덱싱, 스트리밍 응답, 캐시, 백프레셔.
- 신뢰성: 멱등 인덱싱, 재시도, 중단 복구.
- 보안: 로컬 기본, 토큰/비밀 마스킹, 최소 권한.
- 이식성: macOS/Linux, 최소 외부 의존.
- 가시성: 구조화 로그, 트레이스ID, 지표.
- 권한: 파일/터미널 조작은 프로젝트 루트 한정, 파괴적 작업은 확인 필요.
- 오프라인 모드: LM Studio 로컬 LLM과 로컬 임베딩(가능 시)로 네트워크 없이 동작 가능.

## 5. 제약 및 리스크
- 대규모 리포 인덱싱 시간/메모리 부담.
- 외부 임베딩/LLM API 한도 및 비용.
- 웹 검색 결과 신뢰도/저작권 이슈 → 출처/TTL/신뢰점수 관리.
 - 파일/터미널 권한 모델 오남용 방지 및 UX 균형.

## 6. 성공 판단과 롤아웃
- 파일럿 리포 3개에서 e2e 그린(훅 전부 통과) 확인.
- 문서/로그/설정만으로 재현 가능한 실행.
 - 대화 메모리 요약/TTL 동작 e2e 검증.
