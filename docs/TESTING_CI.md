# 테스트/CI/후크 정책

## 게이트(차단 규칙)
- `make fmt` : `gofmt -s` + `goimports` 적용, 포맷 미준수 시 실패.
- `make lint` : `golangci-lint` 기본 규칙 + 금지 패턴(동기화 목적의 `time.Sleep` 등).
- `make test` : 단위/계약/소규모 e2e, CI에서 `-race` 활성화.

## 프리커밋
- 위 3개 게이트 모두 통과하지 않으면 커밋 차단.

## 테스트 전략
- 단위: 청커/리트리버/플래너/프롬프트 컴포저 테이블 기반 테스트.
- 계약: `VectorStore`/`Retriever`/`LLMProvider` 인터페이스 공통 케이스.
- 골든: 프롬프트/샘플 응답 스냅샷(완화 매칭), 회귀 방지.
- e2e: 소형 샘플 리포에서 `index → ask/edit → hooks` 연동 확인.
 - 보안/권한: 파일 경계(루트 밖 접근 차단)와 파괴적 동작 확인 흐름 테스트.
 - 쉘 실행: 시간 제한/출력 제한/허용·차단 목록 동작 테스트, 로그 구조 검증.
 - 메모리: 요약 정확성/TTL/삭제 정책, 세맨틱 캐시 히트율.

## 관측/로그
- 구조화 로그 수집, 실패 시 로그/디프/결과 요약 아티팩트 업로드.
 - 실행 로그(ExecutionLog) 아카이빙 및 재현 스크립트 생성.
